import{R as l,d as D,r as A,u as F,j as E}from"./iframe-Cfz2vXeE.js";import{Z as N,_ as R}from"./index.esm-C1WN7kEu.js";import{a as V,c as L}from"./index-C-OhZ25x.js";import{a as j}from"./Tooltip-BuVThTi0.js";import{u as T}from"./useResponsiveValue-Cmf8jyBD.js";import{u as H}from"./useProvidedStateOrCreate-BEKIGSkE.js";import{u as W}from"./useProvidedRefOrCreate-Pg3blKRP.js";import{i as B}from"./iterate-focusable-elements-QzROm7ZI.js";import{u as q}from"./useMnemonics-D4gqZtvW.js";import{A as U}from"./AnchoredOverlay-DQ90Zw6u.js";import{B as Z}from"./Button-3sCteC9V.js";const _=(n,o,r)=>{const[t,e]=l.useState(void 0);l.useEffect(function(){const c=r?.current,i=u=>{u.detail!==0&&e("mouse-click")},a=u=>{["Space","Enter","ArrowDown","ArrowUp"].includes(u.code)&&e(u.code)};return c?.addEventListener("click",i),c?.addEventListener("keydown",a),()=>{c?.removeEventListener("click",i),c?.removeEventListener("keydown",a)}},[r]),l.useEffect(function(){if(!n||!o?.current)return;const c=B(o.current);if(t==="mouse-click")if(r?.current)r.current.focus();else throw new Error("For focus management, please attach anchorRef");else if(t&&["ArrowDown","Space","Enter"].includes(t)){const i=c.next().value;setTimeout(()=>i?.focus())}else if(t==="ArrowUp"){const i=[...c],a=i[i.length-1];setTimeout(()=>a.focus())}else{const i=c.next().value;setTimeout(()=>i?.focus())}},[n,t,r])},$=(n,o,r,t,e)=>{const s=e===void 0?!1:e;_(n,r,t),q(n,r),G(n,o,r,t),z(n,r,t),X(n,s,o,r)},G=(n,o,r,t)=>{const e=D.c(6);let s,c;e[0]!==t||e[1]!==r||e[2]!==o||e[3]!==n?(s=()=>{const i=r?.current,a=t?.current,u=m=>{n&&m.key==="Tab"&&o?.("tab")};return i?.addEventListener("keydown",u),a?.addEventListener("keydown",u),()=>{i?.removeEventListener("keydown",u),a?.removeEventListener("keydown",u)}},c=[n,o,r,t],e[0]=t,e[1]=r,e[2]=o,e[3]=n,e[4]=s,e[5]=c):(s=e[4],c=e[5]),l.useEffect(s,c)},X=(n,o,r,t)=>{const e=D.c(6);let s,c;e[0]!==t||e[1]!==o||e[2]!==r||e[3]!==n?(s=()=>{const i=t?.current,a=u=>{n&&o&&u.key==="ArrowLeft"&&r?.("arrow-left")};return i?.addEventListener("keydown",a),()=>{i?.removeEventListener("keydown",a)}},c=[n,r,t,o],e[0]=t,e[1]=o,e[2]=r,e[3]=n,e[4]=s,e[5]=c):(s=e[4],c=e[5]),l.useEffect(s,c)},z=(n,o,r)=>{const t=D.c(5);let e,s;t[0]!==r||t[1]!==o||t[2]!==n?(e=()=>{const c=o?.current,i=r?.current,a=u=>{if(!n||!c)return;const m=B(c);if(u.key==="ArrowDown"){const w=m.next().value;setTimeout(()=>w?.focus())}else if(u.key==="ArrowUp"){const w=[...m],p=w[w.length-1];setTimeout(()=>p.focus())}};return i?.addEventListener("keydown",a),()=>i?.addEventListener("keydown",a)},s=[n,o,r],t[0]=r,t[1]=o,t[2]=n,t[3]=e,t[4]=s):(e=t[3],s=t[4]),l.useEffect(e,s)},J="prc-ActionMenu-ActionMenuContainer-XdFHv",P={ActionMenuContainer:J},g=l.createContext({renderAnchor:null,open:!1}),O=(n,o)=>{const r={...n};if(typeof o.onClick=="function"){const t=n.onClick,e=s=>{o.onClick?.(s),t?.(s)};r.onClick=e}if(typeof o.onKeyDown=="function"){const t=n.onKeyDown,e=s=>{o.onKeyDown?.(s),t?.(s)};r.onKeyDown=e}return r},S=({anchorRef:n,open:o,onOpenChange:r,children:t})=>{const e=A.useContext(g),[s,c]=H(o,r,!1),i=l.useCallback(()=>c(!0),[c]),a=T({narrow:!0},!1),u=l.useCallback(d=>{if(!(a&&o&&d==="tab"))switch(c(!1),d){case"tab":case"item-select":e.onClose?.(d)}},[c,e,o,a]),m=l.Children.toArray(t).find(d=>l.isValidElement(d)&&(d.type===k||d.type===x)),w=l.isValidElement(m)?m.props.id:void 0,p=W(n),C=F(w);let y=null;const M=l.Children.map(t,d=>{if(d.type===j){const f=d.props.children;return f.type===k&&(y=b=>{const h=l.cloneElement(f,O({...b},f.props));return l.cloneElement(d,{children:h,ref:p})}),null}else if(d.type===x){const f=d.props.children;return(f!==void 0?f.type===j:!1)?f.props.children!==null&&(y=h=>{const v=f.props.children,K=l.cloneElement(v,O({...h},v.props)),I=l.cloneElement(f,{children:K});return l.cloneElement(d,{children:I,ref:p})}):y=h=>l.cloneElement(d,h),null}else return d.type===k?(y=f=>l.cloneElement(d,O(f,d.props)),null):d});return E.jsx(g.Provider,{value:{anchorRef:p,renderAnchor:y,anchorId:C,open:s,onOpen:i,onClose:u,isSubmenu:e.isSubmenu!==void 0},children:M})},x=l.forwardRef(({children:n,...o},r)=>{const{onOpen:t,isSubmenu:e}=l.useContext(g),s=A.useCallback(m=>{e&&m.key==="ArrowRight"&&!m.defaultPrevented&&t?.("anchor-key-press")},[e,t]),c=m=>{n.props.onClick?.(m),o.onClick?.(m)},i=m=>{n.props.onKeyDown?.(m),s(m),o.onKeyDown?.(m)},a=A.useContext(L),u=A.useMemo(()=>e?{...a,defaultTrailingVisual:E.jsx(N,{}),afterSelect:()=>t?.("anchor-click")}:a,[e,t,a]);return E.jsx(L.Provider,{value:u,children:l.cloneElement(n,{...o,ref:r,onClick:c,onKeyDown:i})})}),k=l.forwardRef(({...n},o)=>E.jsx(x,{ref:o,children:E.jsx(Z,{type:"button",trailingAction:R,...n})})),Q={regular:"anchored",narrow:"anchored"},Y=({children:n,align:o="start",side:r,onPositionChange:t,"aria-labelledby":e,variant:s=Q,...c})=>{const{anchorRef:i,renderAnchor:a,anchorId:u,open:m,onOpen:w,onClose:p,isSubmenu:C=!1}=l.useContext(g),y=l.useRef(null);$(m,p,y,i,C);const M=T({narrow:!0},!1),d=T(s,{regular:"anchored",narrow:"anchored"}),f=!!M&&s.narrow==="fullscreen",[b,h]=A.useState(null);return A.useEffect(()=>{if(i?.current){const v=i.current.getAttribute("aria-labelledby");v&&h(v)}},[i]),E.jsx(U,{anchorRef:i,renderAnchor:a,anchorId:u,open:m,onOpen:w,onClose:p,align:o,side:r??(C?"outside-right":"outside-bottom"),overlayProps:c,focusZoneSettings:f?{disabled:!0}:{focusOutBehavior:"wrap"},onPositionChange:t,variant:s,children:E.jsx("div",{ref:y,className:P.ActionMenuContainer,"data-variant":d,children:E.jsx(L.Provider,{value:{container:"ActionMenu",listRole:"menu",listLabelledBy:e||b||u,selectionAttribute:"aria-checked",afterSelect:()=>p?.("item-select"),enableFocusZone:f},children:n})})})};S.displayName="ActionMenu";const de=Object.assign(S,{Button:k,Anchor:x,Overlay:Y,Divider:V});S.__docgenInfo={description:"",methods:[],displayName:"ActionMenu",props:{children:{required:!0,tsType:{name:"union",raw:"React.ReactElement[] | React.ReactElement",elements:[{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement"}],raw:"React.ReactElement[]"},{name:"ReactReactElement",raw:"React.ReactElement"}]},description:"Recommended: `ActionMenu.Button` or `ActionMenu.Anchor` with `ActionMenu.Overlay`"},open:{required:!1,tsType:{name:"boolean"},description:"If defined, will control the open/closed state of the overlay. Must be used in conjunction with `onOpenChange`."},onOpenChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(s: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"s"}],return:{name:"void"}}},description:"If defined, will control the open/closed state of the overlay. Must be used in conjunction with `open`."}}};export{de as A};
