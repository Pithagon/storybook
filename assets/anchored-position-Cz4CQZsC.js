const C={"outside-top":["outside-bottom","outside-right","outside-left","outside-bottom"],"outside-bottom":["outside-top","outside-right","outside-left","outside-bottom"],"outside-left":["outside-right","outside-bottom","outside-top","outside-bottom"],"outside-right":["outside-left","outside-bottom","outside-top","outside-bottom"]},a={start:["end","center"],end:["start","center"],center:["end","start"]};function E(d,t,e={}){const l=N(d),p=T(l),o=getComputedStyle(l),h=l.getBoundingClientRect(),[i,r]=[o.borderTopWidth,o.borderLeftWidth].map(f=>parseInt(f,10)||0),u={top:h.top+i,left:h.left+r};return _(p,u,d.getBoundingClientRect(),t instanceof Element?t.getBoundingClientRect():t,W(e))}function N(d){if(L(d))return document.body;let t=d.parentNode;for(;t!==null;){if(t instanceof HTMLElement&&getComputedStyle(t).position!=="static")return t;t=t.parentNode}return document.body}function L(d){var t;if(d.tagName==="DIALOG")return!0;try{if(d.matches(":popover-open")&&/native code/.test((t=document.body.showPopover)===null||t===void 0?void 0:t.toString()))return!0}catch{return!1}return!1}function T(d){let t=d;for(;t!==null&&!(!(t instanceof Element)||getComputedStyle(t).overflow!=="visible");)t=t.parentNode;const e=t===document.body||!(t instanceof HTMLElement)?document.body:t,l=e.getBoundingClientRect(),p=getComputedStyle(e),[o,h,i,r]=[p.borderTopWidth,p.borderLeftWidth,p.borderRightWidth,p.borderBottomWidth].map(u=>parseInt(u,10)||0);return{top:l.top+o,left:l.left+h,width:l.width-i-h,height:Math.max(l.height-o-r,e===document.body?window.innerHeight:-1/0)}}const c={side:"outside-bottom",align:"start",anchorOffset:4,alignmentOffset:4,allowOutOfBounds:!1};function W(d={}){var t,e,l,p,o;const h=(t=d.side)!==null&&t!==void 0?t:c.side,i=(e=d.align)!==null&&e!==void 0?e:c.align;return{side:h,align:i,anchorOffset:(l=d.anchorOffset)!==null&&l!==void 0?l:h==="inside-center"?0:c.anchorOffset,alignmentOffset:(p=d.alignmentOffset)!==null&&p!==void 0?p:i!=="center"&&h.startsWith("inside")?c.alignmentOffset:0,allowOutOfBounds:(o=d.allowOutOfBounds)!==null&&o!==void 0?o:c.allowOutOfBounds}}function _(d,t,e,l,{side:p,align:o,allowOutOfBounds:h,anchorOffset:i,alignmentOffset:r}){const u={top:d.top-t.top,left:d.left-t.left,width:d.width,height:d.height};let f=S(e,l,p,o,i,r),s=p,A=o;if(f.top-=t.top,f.left-=t.left,!h){const g=C[p];let y=0;if(g){let w=p;for(;y<g.length&&x(w,f,u,e);){const b=g[y++];w=b,f=S(e,l,b,o,i,r),f.top-=t.top,f.left-=t.left,s=b}}const n=a[o];let B=0;if(n){let w=o;for(;B<n.length&&v(w,f,u,e);){const b=n[B++];w=b,f=S(e,l,s,b,i,r),f.top-=t.top,f.left-=t.left,A=b}}f.top<u.top&&(f.top=u.top),f.left<u.left&&(f.left=u.left),f.left+e.width>d.width+u.left&&(f.left=d.width+u.left-e.width),g&&y<g.length&&f.top+e.height>d.height+u.top&&(f.top=Math.max(d.height+u.top-e.height,0))}return Object.assign(Object.assign({},f),{anchorSide:s,anchorAlign:A})}function S(d,t,e,l,p,o){const h=t.left+t.width,i=t.top+t.height;let r=-1,u=-1;return e==="outside-top"?r=t.top-p-d.height:e==="outside-bottom"?r=i+p:e==="outside-left"?u=t.left-p-d.width:e==="outside-right"&&(u=h+p),(e==="outside-top"||e==="outside-bottom")&&(l==="start"?u=t.left+o:l==="center"?u=t.left-(d.width-t.width)/2+o:u=h-d.width-o),(e==="outside-left"||e==="outside-right")&&(l==="start"?r=t.top+o:l==="center"?r=t.top-(d.height-t.height)/2+o:r=i-d.height-o),e==="inside-top"?r=t.top+p:e==="inside-bottom"?r=i-p-d.height:e==="inside-left"?u=t.left+p:e==="inside-right"?u=h-p-d.width:e==="inside-center"&&(u=(h+t.left)/2-d.width/2+p),e==="inside-top"||e==="inside-bottom"?l==="start"?u=t.left+o:l==="center"?u=t.left-(d.width-t.width)/2+o:u=h-d.width-o:(e==="inside-left"||e==="inside-right"||e==="inside-center")&&(l==="start"?r=t.top+o:l==="center"?r=t.top-(d.height-t.height)/2+o:r=i-d.height-o),{top:r,left:u}}function x(d,t,e,l){return d==="outside-top"||d==="outside-bottom"?t.top<e.top||t.top+l.height>e.height+e.top:t.left<e.left||t.left+l.width>e.width+e.left}function v(d,t,e,l){if(d==="end")return t.left<e.left;if(d==="start"||d==="center")return t.left+l.width>e.left+e.width||t.left<e.left}export{E as g};
