import{r as o,j as e}from"./iframe-Cfz2vXeE.js";import{a3 as S}from"./index.esm-C1WN7kEu.js";import{T as p}from"./Text-BbpDCwQY.js";import{B as T}from"./Button-3sCteC9V.js";var x=[],f=new MessageChannel,F=(function(){this.postMessage(void 0)}).bind(f.port2);function q(n){x.push(n)===1&&requestAnimationFrame(F)}f.port1.onmessage=function(){var n=x;x=[];for(var i=performance.now(),c=0;c<n.length;c++)n[c](i)},f=null;const z="prc-utils-Root-4LUlA",B="prc-utils-Header--MWj1",E="prc-utils-HeaderRow-5-I74",$="prc-utils-HeaderColumn-7P9OE",O="prc-utils-Container-qlOsm",k="prc-utils-Footer-LLa7w",A="prc-utils-Box-SM5wy",a={Root:z,Header:B,HeaderRow:E,HeaderColumn:$,Container:O,Footer:k,Box:A},_=({componentName:n,title:i,description:c,totalIterations:t,renderIteration:v})=>{const u=o.useRef(),[r,h]=o.useState(0),[g,j]=o.useState(void 0),[R,b]=o.useState(void 0),[y,w]=o.useState(void 0),[C,H]=o.useState(void 0),d=o.useRef(null);o.useEffect(()=>(d.current||(d.current=L()),()=>{d.current&&(d.current.observer.disconnect(),d.current=null)}),[]);const N=()=>{h(0),u.current=performance.now();let s=0;const m=setInterval(()=>{if(s<t-1){const l=I();h(M=>M+1),q(()=>{l.end()}),s++}else clearInterval(m)},10)};return o.useEffect(()=>{if(r===t-1){const s=d.current?.data??[];j(s.sort((m,l)=>m-l)[Math.floor(s.length/2)]),b(s.reduce((m,l)=>m+l,0)/s.length),w(Math.min(...s)),H(Math.max(...s))}},[r,t]),e.jsxs("div",{className:a.Root,children:[e.jsxs("div",{className:a.Header,children:[e.jsxs("div",{className:a.HeaderColumn,children:[e.jsxs("div",{className:a.HeaderRow,children:[e.jsx(S,{size:16}),e.jsx(p,{size:"large",weight:"semibold",children:e.jsx("code",{children:n})})]}),e.jsx("div",{className:a.HeaderRow,children:e.jsxs(p,{size:"medium",color:"fg.muted",children:[i,": ",c]})})]}),e.jsx("div",{className:a.HeaderColumn,children:e.jsx(T,{variant:"primary",disabled:r!==0&&r!==t-1,onClick:N,loading:r!==0&&r!==t-1,size:"large","data-testid":"start",children:r===0?"Start":"Re-run"})})]}),e.jsx("div",{className:a.Container,children:e.jsx("div",{className:a.Box,children:v(r,t)})}),e.jsx("div",{className:a.Footer,children:e.jsx(p,{size:"medium",color:"fg.muted",children:e.jsx("code",{children:r===0?"Click 'Start' to start the test":r===t-1?e.jsxs(e.Fragment,{children:[e.jsxs("strong",{children:["Median: ",e.jsx("span",{"data-testid":"result",children:g?.toFixed(2)}),"ms"]}),`  |  Average: ${R?.toFixed(2)}ms  |  `,`Min: ${y?.toFixed(2)}ms  |  `,`Max: ${C?.toFixed(2)}ms`]}):`Step ${r}/${t} â€” ${((performance.now()-(u.current??0))/1e3).toFixed(0)}s`})})})]})};function I(){return performance.mark("interaction-start"),{end(){performance.mark("interaction-end"),performance.measure("interaction-duration","interaction-start","interaction-end")}}}const L=()=>{const n=[],i=new PerformanceObserver(function(t,v){for(const u of t.getEntries())u.entryType==="measure"&&n.push(u.duration)});return i.observe({entryTypes:["measure"]}),{data:n,observer:i}};_.__docgenInfo={description:"",methods:[],displayName:"StressTest",props:{componentName:{required:!0,tsType:{name:"string"},description:""},title:{required:!0,tsType:{name:"string"},description:""},description:{required:!0,tsType:{name:"string"},description:""},totalIterations:{required:!0,tsType:{name:"number"},description:""},renderIteration:{required:!0,tsType:{name:"signature",type:"function",raw:"(count: number, totalIterations: number) => React.ReactNode",signature:{arguments:[{type:{name:"number"},name:"count"},{type:{name:"number"},name:"totalIterations"}],return:{name:"ReactReactNode",raw:"React.ReactNode"}}},description:""}}};export{_ as S};
